<!DOCTYPE html>
<html class="<%= theme %>" lang="en" id="html">
<head>
    <link rel="icon" href="/public/favicon.ico">
    <link rel="icon" rel="apple-touch-icon" href="/public/favicon.ico">
    <%- include('../meta/index', { title: 'Dashboard' }); %>
</head>
<body class="bg-meowmail-main dark:bg-ayyblue-black">
    <%- include('../meta/nav'); %>
    <div id="editDisplay" class="">
      <h1 class="font-bold text-4xl text-center my-2 mx-2 dark:text-white">Your dashboard: <div class="w-fit m-auto text-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-search mt-2" data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Preview page" onclick="previewDisplay()" viewBox="0 0 16 16"> <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/> </svg></div></h1>
      <div class="w-fit m-auto break-words p-2 text-lg"><% if (acc.pro) {%>
          <div class="w-fit m-auto" data-bs-toggle="modal" data-bs-target="#changeBANNER"><img src="/banner/<%= acc.uuid %>" class="m-auto rounded object-fill w-fit lg:w-[400px] h-[140px] text-center" draggable="false" data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Click to change banner" alt="Click to change banner"></div><%}%>
          <div class="w-fit m-auto rounded-full hover:cursor-pointer dark:text-white" data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Click to change avatar"><img src="/avatar/<%= acc.uuid %>" class="w-[128px] h-[128px] rounded-full border-[2px] border-black mb-4 <% if (acc.banner !== '') {%> -mt-[85px]<%}%>" draggable="false" data-bs-toggle="modal" data-bs-target="#changePFP"></div>
          <hr class="w-1/2 m-auto dark:text-white dark:p-[1px]"/>
          <div class="hidden" role="alert" id="error"></div>
          <div class="my-2"></div><% if (acc.verified) {%>
          <form id="mainUpdate-form" class="p-1 m-auto w-fit">
              <div class="flex flex-auto gap-2">
                  <div class="form-floating mb-2 break-words">
                      <input type="text" class="form-control" placeholder="Update your display name" id="updateDisplay" name="display_vr" value="<%=acc.displayName%>" autocomplete="off"></input>
                      <label for="updateDisplay">Display</label>
                  </div>
                  <div class="form-floating mb-2 break-words">
                      <input type="text" class="form-control" placeholder="Update your username" id="updateUsername" name="name_vr" value="<%=acc.name%>" autocomplete="off"></input>
                      <label for="updateUsername">Username</label>
                  </div>
                  <div class="form-floating mb-2 break-words">
                      <input type="text" class="form-control" placeholder="Update your location" id="updateLocation" name="location_vr" value="<%=acc.location%>" autocomplete="off"></input>
                      <label for="updateLocation">Location</label>
                  </div>
                  <div class="form-floating mb-2 break-words">
                      <input type="text" class="form-control" placeholder="Update your bio" id="updateBio" name="bio_vr" value="<%=acc.bio%>" autocomplete="off"></input>
                      <label for="updateBio">Bio</label>
                  </div><% if (acc.pro) {%>
                  <div class="mt-3">
                      <div class="form-check form-switch w-fit m-auto"><% if (acc.theme !== "dark") {%>
                          <input class="form-check-input" type="checkbox" role="switch" id="updateTheme" name="darktheme_vr"><%} if (acc.theme == "dark") {%>
                          <input class="form-check-input" type="checkbox" role="switch" id="updateTheme" name="darktheme_vr" checked><%}%>
                          <label class="form-check-label dark:text-white" for="updateTheme">Dark mode</label>
                      </div>
                  </div><%}%>
              </div>
              <div class="w-min m-auto mt-2">
                  <button type="submit" class="btn btn-primary" style="background-color: rgb(51, 136, 157); border-color: black; border-width: .5px;" type="submit" id="register_button">Submit</button>
                  <div class="my-2"></div>
                  <img id="loading" src="/public/i/assets/radar_loading.svg" width="84" height="84" class="hidden" draggable="false">
              </div>
          </form>
          <div class="my-3"></div>
          <div class="w-fit border-black border-1 bg-zinc-300 dark:bg-zinc-700 dark:border-white p-3 m-auto">
              <div class="w-fit p-4 m-auto flex flex-wrap gap-2">
                  <div class="flex align-middle w-fit m-auto hover:underline hover:cursor-pointer dark:text-white" id="createLink_VR" onclick="createLink()">
                      <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-link-45deg" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"/><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"/></svg>
                      <p>Create link</p>
                  </div>
                  <div class="flex align-middle w-fit m-auto hover:underline hover:cursor-pointer dark:text-white" id="createQR_VR" onclick="createQR()">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-qr-code" viewBox="0 0 16 16"><path d="M2 2h2v2H2V2Z"/><path d="M6 0v6H0V0h6ZM5 1H1v4h4V1ZM4 12H2v2h2v-2Z"/><path d="M6 10v6H0v-6h6Zm-5 1v4h4v-4H1Zm11-9h2v2h-2V2Z"/><path d="M10 0v6h6V0h-6Zm5 1v4h-4V1h4ZM8 1V0h1v2H8v2H7V1h1Zm0 5V4h1v2H8ZM6 8V7h1V6h1v2h1V7h5v1h-4v1H7V8H6Zm0 0v1H2V8H1v1H0V7h3v1h3Zm10 1h-1V7h1v2Zm-1 0h-1v2h2v-1h-1V9Zm-4 0h2v1h-1v1h-1V9Zm2 3v-1h-1v1h-1v1H9v1h3v-2h1Zm0 0h3v1h-2v1h-1v-2Zm-4-1v1h1v-2H7v1h2Z"/><path d="M7 12h1v3h4v1H7v-4Zm9 2v2h-3v-1h2v-1h1Z"/></svg>
                      <p class="ml-2">View QR Code</p>
                  </div>
              </div>
              <div class="hidden" id="createLink2_VR">
                  <form id="nL-form" class="p-2 m-auto">
                      <div class="gap-2">
                          <div class="form-floating mb-2 break-all">
                              <input type="url" class="form-control" placeholder="Link" id="addURL" name="url_vr" autocomplete="off"></input>
                              <label for="addURL">URL</label>
                          </div>
                          <div class="form-floating mb-2 break-all">
                              <input type="text" class="form-control" placeholder="Title" id="addTitle" name="title_vr" autocomplete="off"></input>
                              <label for="addTitle">Title</label>
                          </div>
                          <div class="form-floating mb-2 break-all">
                              <input type="text" class="form-control" placeholder="Subtitle" id="addSubtitle" name="subtitle_vr" autocomplete="off"></input>
                              <label for="addSubtitle">Subtitle</label>
                          </div><% if (acc.pro) {%>
                          <div class="form-check form-switch w-fit m-auto">
                              <input class="form-check-input" type="checkbox" role="switch" id="highlight-link" name="highlight_vr">
                              <label class="form-check-label dark:text-white" for="highlight-link">Highlight</label>
                          </div><%}%>
                      </div>
                      <hr/>
                      <div class="w-fit m-auto mt-2">
                          <div class="w-fit p-8 m-auto flex flex-wrap gap-2">
                              <% if (links.length < acc.linklimit) {%><button type="submit" class="btn btn-primary" style="background-color: rgb(51, 136, 157); border-color: black; border-width: .5px;" type="submit" id="register_button">Add link</button><%}%>
                              <% if (links.length == acc.linklimit) {%><span data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="You reached the maximum number of links"><button type="submit" disabled class="btn btn-primary" style="background-color: rgb(51, 136, 157); border-color: black; border-width: .5px;" type="submit" id="disabled_button">Add link</button></span><%}%>
                              <% if (links.length !== acc.linklimit && links.length > acc.linklimit) {%><span data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="You reached the maximum number of links"><button type="submit" disabled class="btn btn-primary" style="background-color: rgb(51, 136, 157); border-color: black; border-width: .5px;" type="submit" id="disabled_button">Add link</button></span><%}%>
                              <h4 class="mt-2 dark:text-white"><%=links.length%>/<%=acc.linklimit%></h4>
                          </div>
                          <div class="my-2"></div>
                          <img id="loading" src="/public/i/assets/radar_loading.svg" width="84" height="84" class="hidden" draggable="false">
                      </div>
                  </form>
              </div>
              <div class="hidden" id="createQR2_VR">
                  <% if (qr) {%><a class="hover:text-current w-fit m-auto" href="<%=qr%>" download="qrcode.png"><img src="<%=qr%>" draggable="false"></a><%} else {%><h1 class="text-2xl w-fit m-auto">Unable to load QR code.</h1><%}%>
              </div>
          </div>
          <div class="w-[90%] p-8 m-auto flex flex-wrap gap-2"><% if (links) { links.sort((a, b) => { return a.order - b.order }); links.forEach(elm => {%>
              <div class="border-2 border-black bg-zinc-300 dark:bg-zinc-700 dark:text-white dark:border-white rounded-lg w-[50%] lg:w-[320px] text-center m-auto p-4">
                  <a class="hover:text-current font-bold<% if (elm.highlight) {%> animate-pulse<%}%>" href="/l/<%=elm.id%>" title="<%=elm.link%>" target="_blank"><div class="w-fit m-auto">
                      <img src="<%=elm.thumbnail%>" class="w-[75px] h-[75px] rounded hover:scale-110" style="vertical-align:middle; transition: 200ms;" draggable="false">
                  </div>
                  <div class="m-auto w-fit">
                      <%=elm.title%><% if (elm.subtitle !== "") {%>
                      <span class="text-gray-700 dark:text-gray-400 figure-caption"><%=elm.subtitle%></span><%}%>
                  </div></a>
                  <div class="w-fit m-auto flex flex-wrap gap-2">
                      <input type="text" class="hidden" name="dismiss_vr" value="<%=elm.uuid%>">
                      <span data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="Remove"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-x-square-fill align-middle mt-1 m-auto w-fit hover:cursor-pointer" id="<%=elm.uuid%>-dismiss" onclick="dismiss('<%=elm.uuid%>')" viewBox="0 0 16 16"><path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm3.354 4.646L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 1 1 .708-.708z"/></svg></span>
                      <input type="text" class="hidden" name="edit_vr" value="<%=elm.uuid%>">
                      <span data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="Edit"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-pencil-square align-middle mt-1 m-auto w-fit hover:cursor-pointer" draggable="false" data-bs-toggle="modal" data-bs-target="#edit-<%=elm.uuid%>" viewBox="0 0 16 16"><path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/><path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/></svg></span>
                  </div>
              </div>
              <form id="<%=elm.uuid%>-form">
                  <div class="modal fade" id="edit-<%=elm.uuid%>" tabindex="-1" aria-labelledby="edit-<%=elm.uuid%>" aria-hidden="true">
                      <div class="modal-dialog my-8 md:my-2">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h5 class="modal-title text-black" id="editModalLabel">Edit Link <svg xmlns="http://www.w3.org/2000/svg" draggable="false" width="16" height="16" fill="currentColor" class="bi bi-pencil-square inline-flex" viewBox="0 0 16 16"> <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/> <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/> </svg></h5>
                          <button type="button" data-bs-dismiss="modal" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16"> <path fill-rule="evenodd" d="M13.854 2.146a.5.5 0 0 1 0 .708l-11 11a.5.5 0 0 1-.708-.708l11-11a.5.5 0 0 1 .708 0Z"/> <path fill-rule="evenodd" d="M2.146 2.146a.5.5 0 0 0 0 .708l11 11a.5.5 0 0 0 .708-.708l-11-11a.5.5 0 0 0-.708 0Z"/> </svg></button>
                        </div>
                        <div class="modal-body text-black">
                          <div id="errorLi-<%=elm.uuid%>" class="" role="alert" style="max-width: max-content; margin: auto;"></div>
                          <div class="form-row align-items-center">
                            <div class="form-row align-items-center">
                              <div class="col-auto" style="width: 75%; margin: auto;">
                                  <div class="form-floating mb-2 break-all">
                                      <input type="url" class="form-control" placeholder="Link" id="editLink" name="url_vr" value="<%=elm.link%>" autocomplete="off"></input>
                                      <label for="addTitle">Link</label>
                                  </div>
                                  <div class="form-floating mb-2 break-all">
                                      <input type="text" class="form-control" placeholder="Title" id="addTitle" name="title_vr" value="<%=elm.title%>" autocomplete="off"></input>
                                      <label for="addTitle">Title</label>
                                  </div>
                                  <div class="form-floating mb-2 break-all">
                                      <input type="text" class="form-control" placeholder="Subtitle" id="addSubtitle" name="subtitle_vr" value="<%=elm.subtitle%>" autocomplete="off"></input>
                                      <label for="addSubtitle">Subtitle</label>
                                  </div>
                                  <div class="form-floating mb-2 break-all">
                                      <input type="text" class="form-control" placeholder="Order" id="addOrder" name="order_vr" value="<%=elm.order%>" autocomplete="off"></input>
                                      <label for="addOrder">Order</label>
                                  </div><% if (acc.pro) {%>
                                  <div class="form-check form-switch w-fit m-auto">
                                      <% if (!elm.highlight) {%><input class="form-check-input" type="checkbox" role="switch" id="highlight-linkEdit" name="highlight_vr"><%}%>
                                      <% if (elm.highlight) {%><input class="form-check-input" type="checkbox" role="switch" id="highlight-linkEdit" name="highlight_vr" checked><%}%>
                                      <label class="form-check-label" for="highlight-linkEdit">Highlight</label>
                                  </div><%}%>
                              </div>
                            </div>
                            <div class="w-fit m-auto">
                              <div class="hidden" id="Lispinner-<%=elm.uuid%>" role="status">
                                  <span class="visually-hidden">Loading...</span>
                              </div>
                            </div>
                            <div class="modal-footer">
                              <button type="button" class="btn btn-secondary" style="background-color: rgb(121, 121, 133); border-color: black; border-width: .5px;" data-bs-dismiss="modal">Close</button>
                              <button type="submit" class="btn btn-secondary" style="background-color: rgb(51, 136, 157); border-color: black; border-width: .5px;">Save changes</button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </form>
              <%})}%>
          </div><%} else {%>
          <form id="mainVerify-form" class="p-2 m-auto">
              <div class="flex flex-auto gap-2">
                  <div class="form-floating mb-2 break-all">
                      <input type="text" class="form-control" placeholder="Enter verification code" id="updateVerify" name="verifcode" maxlength="9" autocomplete="off" value="<% if (code) {%><%=code%><%}%>" required></input>
                      <label for="updateDisplay">Verification Code</label>
                  </div>
              </div>
              <hr/>
              <div class="w-fit m-auto mt-2">
                  <button type="submit" class="btn btn-primary" style="background-color: rgb(51, 136, 157); border-color: black; border-width: .5px;" type="submit" id="register_button">Verify E-Mail</button>
                  <div class="my-2"></div>
                  <img id="loading" src="/public/i/assets/radar_loading.svg" width="84" height="84" class="hidden" draggable="false">
              </div>
          </form>
          <div class="w-fit m-auto"><button type="submit" class="btn btn-primary mt-2" style="background-color: rgb(51, 136, 157); border-color: black; border-width: .5px;" type="submit" id="resend_button">Resend code</button></div><%}%>
  
          <form id="avatar-form">
              <div class="modal fade" id="changePFP" tabindex="-1" aria-labelledby="changePFPModalLabel" aria-hidden="true">
                  <div class="modal-dialog my-8 md:my-2">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title text-black" id="editModalLabel">Edit Avatar <svg xmlns="http://www.w3.org/2000/svg" draggable="false" width="16" height="16" fill="currentColor" class="bi bi-pencil-square inline-flex" viewBox="0 0 16 16"> <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/> <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/> </svg></h5>
                      <button type="button" data-bs-dismiss="modal" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16"> <path fill-rule="evenodd" d="M13.854 2.146a.5.5 0 0 1 0 .708l-11 11a.5.5 0 0 1-.708-.708l11-11a.5.5 0 0 1 .708 0Z"/> <path fill-rule="evenodd" d="M2.146 2.146a.5.5 0 0 0 0 .708l11 11a.5.5 0 0 0 .708-.708l-11-11a.5.5 0 0 0-.708 0Z"/> </svg></button>
                    </div>
                    <div class="modal-body text-black">
                      <div id="errorAv" class="" role="alert" style="max-width: max-content; margin: auto;"></div>
                      <div class="form-row align-items-center">
                        <div class="form-row align-items-center">
                          <div class="col-auto" style="width: 75%; margin: auto;">
                            <label class="sr-only" for="AvatarFile">Avatar</label>
                            <input type="file" class="form-control" id="AvatarFile" name="pfp" accept="image/*">
                            <div class="my-1"></div>
                          </div>
                        </div>
                        <div class="hidden" id="AVspinner" role="status">
                          <span class="visually-hidden">Loading...</span>
                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" style="background-color: rgb(121, 121, 133); border-color: black; border-width: .5px;" data-bs-dismiss="modal">Close</button>
                          <button type="submit" class="btn btn-secondary" style="background-color: rgb(51, 136, 157); border-color: black; border-width: .5px;">Save changes</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </form>
            <form id="banner-form">
              <div class="modal fade" id="changeBANNER" tabindex="-1" aria-labelledby="changeBANNERModalLabel" aria-hidden="true">
                  <div class="modal-dialog my-8 md:my-2">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title text-black" id="editModalLabel">Edit Banner <svg xmlns="http://www.w3.org/2000/svg" draggable="false" width="16" height="16" fill="currentColor" class="bi bi-pencil-square inline-flex" viewBox="0 0 16 16"> <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/> <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/> </svg></h5>
                      <button type="button" data-bs-dismiss="modal" aria-label="Close"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16"> <path fill-rule="evenodd" d="M13.854 2.146a.5.5 0 0 1 0 .708l-11 11a.5.5 0 0 1-.708-.708l11-11a.5.5 0 0 1 .708 0Z"/> <path fill-rule="evenodd" d="M2.146 2.146a.5.5 0 0 0 0 .708l11 11a.5.5 0 0 0 .708-.708l-11-11a.5.5 0 0 0-.708 0Z"/> </svg></button>
                    </div>
                    <div class="modal-body text-black">
                      <div id="errorBn" class="" role="alert" style="max-width: max-content; margin: auto;"></div>
                      <div class="form-row align-items-center">
                        <div class="form-row align-items-center">
                          <div class="col-auto" style="width: 75%; margin: auto;">
                            <label class="sr-only" for="BannerFile">Banner</label>
                            <input type="file" class="form-control" id="BannerFile" name="banner" accept="image/*">
                            <div class="my-1"></div>
                          </div>
                        </div>
                        <div class="hidden" id="BNspinner" role="status">
                          <span class="visually-hidden">Loading...</span>
                        </div>
                        <div class="modal-footer">
                          <button type="button" class="btn btn-secondary" style="background-color: rgb(121, 121, 133); border-color: black; border-width: .5px;" data-bs-dismiss="modal">Close</button>
                          <button type="submit" class="btn btn-secondary" style="background-color: rgb(51, 136, 157); border-color: black; border-width: .5px;">Save changes</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </form>
      </div>
    </div>
    <div id="previewDisplay" class="hidden">
      <h1 class="font-bold text-4xl text-center my-2 mx-2 dark:text-white">Your dashboard: <div class="w-fit m-auto text-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-search mt-2" data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Preview page" onclick="previewDisplay()" viewBox="0 0 16 16"> <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/> </svg></div></h1>
      <div id="background-image-wrapper" style="background-image: url('/banner/<%=acc.uuid%>'); background-repeat: no-repeat; background-size: cover; background-position: center;">
        <div class="w-fit m-auto break-words p-2 text-lg text-center dark:text-white">
            <div class="bg-zinc-300 dark:bg-zinc-700 p-2 rounded border-2 border-black mt-12">
                <img src="/avatar/<%= acc.uuid %>" class="w-[128px] h-[128px] rounded-full border-[2px] border-black mb-2 bg-zinc-300" style="margin: auto; margin-top: -45px;" draggable="false">
                <h2 class="font-bold text-4xl inline-flex"><%= acc.displayName %><% if (acc.vrverified) {%><a href="/help/verified-accounts" class="hover:text-current w-fit h-fit"><img src="/public/i/assets/verified<% if (theme == 'dark') {%>_dark<%}%>.svg" class="ml-1 mt-3" title="Verified badge" draggable="false"></a><%}%><% if (acc.ogname) {%><a href="/help/rare-usernames" class="hover:text-current w-fit h-fit"><img src="/public/i/assets/og<% if (theme == 'dark') {%>_dark<%}%>.svg" class="ml-1 <% if (view.vrverified) {%>mt-3<%} else {%>mt-[12.5px]<%}%> w-[18px] h-[18px]" title="Rare Username badge" draggable="false"></a><%}%></h2><% if (acc.location && acc.location !== "" && acc.location !== " ") {%>
                <h4 class="font-bold text-xl text-gray-600 dark:text-gray-400 flex w-fit m-auto"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="gray" class="bi bi-geo-alt-fill mt-[6.5px]" viewBox="0 0 16 16"><path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/></svg><%=acc.location%></h4><%}%><% if (acc.bio && acc.bio !== "" && acc.bio !== " ") {%>
                <h4 class="font-bold text-2xl"><%=acc.bio%></h4><%}%>
                <hr class="mt-2"/>
            </div>
        </div>
        <div class="mt-6"></div>
      </div>
      <hr class="mb-2 w-1/3 m-auto dark:text-white" style="height: 2.5px;"/>
      <div class="w-[90%] lg:w-fit p-8 m-auto flex flex-wrap gap-2"><% if (links) { links.sort((a, b) => { return a.order - b.order }); links.forEach(elm => {%>
          <div class="border-2 border-black bg-zinc-300 dark:bg-zinc-700 dark:text-white rounded-lg m-auto w-[50%] lg:w-[320px] p-4">
              <a class="hover:text-current font-bold<% if (elm.highlight) {%> animate-[pulse_2.5s_ease-out_infinite]<%}%>" href="/l/<%=elm.id%>" title="<%=elm.link%>" target="_blank"><div class="w-fit m-auto">
                  <img src="<%=elm.thumbnail%>" class="w-[75px] rounded hover:scale-110" style="vertical-align:middle; transition: 200ms;" draggable="false">
              </div>
              <div class="m-auto text-center">
                  <%=elm.title%><% if (elm.subtitle !== "") {%>
                  <span class="text-gray-700 dark:text-gray-400 figure-caption"><%=elm.subtitle%></span><%}%>
              </div></a>
          </div><%})}%>
      </div>
    </div>
    <script defer>
        const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
        const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
        
        function previewDisplay() {
            let edit = document.getElementById('editDisplay');
            let preview = document.getElementById('previewDisplay');
            let change = preview.getAttribute('class');
            
            if (change == "hidden") {
              edit.setAttribute('class', 'hidden');
              preview.setAttribute('class', 'w-fit m-auto');
            };
            if (change !== "hidden") {
              preview.setAttribute('class', 'hidden');
              edit.setAttribute('class', 'w-fit m-auto');
            };
        };

        function createLink() {
            let two = document.getElementById('createLink2_VR');
            let change = two.getAttribute('class');
            
            if (change == "hidden") {
                two.setAttribute('class', 'w-fit m-auto');
            };
            if (change !== "hidden") {
                two.setAttribute('class', 'hidden');
            };
        };
        function createQR() {
            let two = document.getElementById('createQR2_VR');
            let change = two.getAttribute('class');
            
            if (change == "hidden") {
                two.setAttribute('class', 'w-fit m-auto');
            };
            if (change !== "hidden") {
                two.setAttribute('class', 'hidden');
            };
        };
        function getBase64(file) {
          if (!file) return
          return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve(reader.result);
            reader.onerror = error => reject(error);
          });
        }<% if (!acc.verified) {%>
        $('#mainVerify-form').submit(function (e) {
            e.preventDefault();
            const formData = new URLSearchParams(new FormData(this));

            $('#error').text('');
            $('#error').toggleClass(false);
            let loading = document.getElementById('loading');

            fetch(`/api/v1/verify/<%=acc.uuid%>?json=true`, { method: 'post', body: formData }).then((r)=>r.json()).then((b)=>{
                loading.setAttribute('class', 'hidden');
                if (!b.OK) {
                    $('#error').text(b.error);
                    $('#error').addClass('alert alert-danger break-normal my-1 text-center');
                } else {
                    window.location.assign(`/dashboard`);
                };
            });
    
            loading.setAttribute('class', 'm-auto mt-1');
        });
        $('#resend_button').click(function (e) {
            e.preventDefault();
            const formData = new FormData();
            formData.append("verifcode", "resend");

            $('#error').text('');
            $('#error').toggleClass(false);
            let loading = document.getElementById('loading');

            fetch(`/api/v1/verify/<%=acc.uuid%>?json=true&resend=true`, { method: 'post', body: formData }).then((r)=>r.json()).then((b)=>{
                loading.setAttribute('class', 'hidden');
                if (!b.OK) {
                    $('#error').text(b.error);
                    $('#error').addClass('alert alert-danger break-normal my-1 text-center');
                } else {
                    window.location.assign(`/dashboard`);
                };
            });
    
            loading.setAttribute('class', 'm-auto mt-1');
        });<%}%>

        $('#mainUpdate-form').submit(function (e) {
            e.preventDefault();
            const formData = new URLSearchParams(new FormData(this));

            $('#error').text('');
            $('#error').toggleClass(false);
            let loading = document.getElementById('loading');

            fetch(`/api/v1/account/edit`, { method: 'post', body: formData }).then((r)=>r.json()).then((b)=>{
                loading.setAttribute('class', 'hidden');
                if (b.OK) {
                    console.log(b);
                    window.location.assign(`/dashboard`);
                } else {
                    $('#error').text(b.error);
                    $('#error').addClass('alert alert-danger break-normal my-1 text-center');
                };
            });
    
            loading.setAttribute('class', 'm-auto mt-1');
        });

        $('#nL-form').submit(function (e) {
            e.preventDefault();
            const formData = new URLSearchParams(new FormData(this));

            $('#error').text('');
            $('#error').toggleClass(false);
            let loading = document.getElementById('loading');

            fetch(`/api/v1/create_url`, { method: 'post', body: formData }).then((r)=>r.json()).then((b)=>{
                loading.setAttribute('class', 'hidden');
                if (b.OK) {
                    console.log(b);
                    window.location.assign(`/dashboard`);
                } else {
                    $('#error').text(b.error);
                    $('#error').addClass('alert alert-danger break-normal my-1 text-center');
                };
            });
    
            loading.setAttribute('class', 'm-auto mt-1');
        });

        $('#avatar-form').submit(function (e) {
            e.preventDefault();
            const formData = new FormData();
            let d = document.getElementById('AvatarFile');
            let av = document.getElementById('AVspinner');
            let dd = new FileReader();
            formData.append("pfp", d.files[0]);

            av.setAttribute('class', 'm-auto spinner-border');
            fetch('/api/v1/account/edit/avatar', { method: 'post', body: formData }).then((r)=>r.json()).then((w)=>{
              $('#errorAv').text('');
              $('#error').toggleClass(false);
              av.setAttribute('class', 'hidden');
              if (w.OK) {
                $('#errorAv').text(w.text);
                $('#errorAv').addClass('alert alert-success my-1');
              } else {
                $('#errorAv').text(w.error);
                $('#errorAv').addClass('alert alert-danger my-1');
              }
            }).catch(e => {
              console.log(e);
              $('#errorAv').text(e);
              $('#errorAv').addClass('alert alert-danger my-1');
            });
        });<% if (acc.pro) {%>
        $('#banner-form').submit(function (e) {
            e.preventDefault();
            const formData = new FormData();
            let d = document.getElementById('BannerFile');
            let av = document.getElementById('BNspinner');
            let dd = new FileReader();
            formData.append("banner", d.files[0]);

            av.setAttribute('class', 'm-auto spinner-border');
            fetch('/api/v1/account/edit/banner', { method: 'post', body: formData }).then((r)=>r.json()).then((w)=>{
              $('#errorBn').text('');
              $('#error').toggleClass(false);
              av.setAttribute('class', 'hidden');
              if (w.OK) {
                $('#errorBn').text(w.text);
                $('#errorBn').addClass('alert alert-success my-1');
              } else {
                $('#errorBn').text(w.error);
                $('#errorBn').addClass('alert alert-danger my-1');
              }
            }).catch(e => {
              console.log(e);
              $('#errorBn').text(e);
              $('#errorBn').addClass('alert alert-danger my-1');
            });
        });<%}%><% if (links) {%>
            function dismiss(uuid) {
                fetch(`/api/v1/remove_url/${uuid}`, { method: 'get' }).then((r)=>r.json()).then((w)=>{
                    $('#error').text('');
                    $('#error').toggleClass(false);
                    console.log(w.error);
                    if (!w.error) {
                      if (w.OK) return window.location.reload();
                    } else {
                      $('#error').text(w.error);
                      $('#error').addClass('alert alert-danger m-auto my-2 w-fit');
                    }
                }).catch(e => {
                  console.log(e);
                  window.location.assign('/dashboard');
                });
            };<% links.forEach((elm) => {%>
            $('#<%=elm.uuid%>-form').submit(function (e) {
                e.preventDefault();
                const formData = new URLSearchParams(new FormData(this));
                let av = document.getElementById('Lispinner-<%=elm.uuid%>');

                av.setAttribute('class', 'spinner-border');
                fetch('/api/v1/edit_url/<%=elm.uuid%>', { method: 'post', body: formData }).then((r)=>r.json()).then((w)=>{
                  $('#errorLi-<%=elm.uuid%>').text('');
                  $('#error').toggleClass(false);
                  av.setAttribute('class', 'hidden');
                  if (w.OK) {
                    $('#errorLi-<%=elm.uuid%>').text(w.text);
                    $('#errorLi-<%=elm.uuid%>').addClass('alert alert-success my-1');
                  } else {
                    $('#errorLi-<%=elm.uuid%>').text(w.error);
                    $('#errorLi-<%=elm.uuid%>').addClass('alert alert-danger my-1');
                  }
                }).catch(e => {
                  console.log(e);
                  $('#errorLi-<%=elm.uuid%>').text(e);
                  $('#errorLi-<%=elm.uuid%>').addClass('alert alert-danger my-1');
                });
            });<%})%>
        <%}%>

        fetch('/api/v1/account?name=<%=acc.nameToFind%>').json();
    </script>
</body>
</html>